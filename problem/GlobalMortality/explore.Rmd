---
title: 'Global Mortality'
output: html_notebook
---

```{r}
library(openxlsx)
library(tidyverse)
```

```{r}
data <- read.xlsx('https://github.com/rfordatascience/tidytuesday/raw/master/data/2018-04-16/global_mortality.xlsx') %>%
  filter(country == 'Sweden') %>%
  mutate(Year = year) %>%
  select(-c(country, country_code, year)) %>%
  gather('Cause', 'Percentage', -Year) %>%
  mutate(Cause = str_replace(Cause, '\\.\\(%\\)', ''),
         Cause = str_replace_all(Cause, '\\.', ' '),
         Cause = str_to_title(Cause))
```

## Top 10 Causes of Death in Sweden in 2016

```{r, dev = 'svg'}
data %>%
  filter(Year == max(Year)) %>%
  mutate(Cause = fct_lump(Cause, n = 10, w = Percentage, other_level = 'Other')) %>%
  mutate(Cause = fct_reorder(Cause, Percentage)) %>%
  ggplot(aes(Cause, Percentage, fill = Cause)) +
  geom_col() +
  theme(legend.position = 'none') +
  coord_flip()
```